---
layout: default
title: Analisi statica di documenti e software malevoli
description: Prof.ssa Federica Paci
---

# Analisi statica di documenti pdf malevoli

L'analisi statica di un documento PDF malevolo è il processo di esaminare il file senza eseguirlo, al fine di identificare possibili minacce e tecniche di attacco utilizzate. Questo tipo di analisi è essenziale per comprendere il comportamento di un file sospetto e per mitigare i rischi associati. Ecco i passaggi dettagliati su come effettuare l'analisi statica di un documento PDF malevolo:

## Analisi statica con yara 

YARA è un linguaggio e strumento di matching pattern progettato per identificare e categorizzare i campioni di malware. Si basa su regole scritte in un linguaggio specifico che consente di descrivere pattern di byte, stringhe di testo e altre caratteristiche che possono essere utilizzate per rilevare malware. 

Per eseguire la classificazione di un documento pdf con yara aprite un terminale e digitate il seguente comando:

```
# yara -w -m -s <PATH ALLA DIRECTORY CON LE REGOLE> suspicious.pdf
```

## Identificazione di Metadati e Struttura del PDF

Un documento PDF inizia con un'intestazione che specifica la versione del formato PDF. Il corpo del PDF contiene tutti gli oggetti definiti nel documento. Gli oggetti possono includere testi, immagini, annotazioni, riferimenti ai font, e codice Javascript. In particolare gli oggetti di tipo stream possono contenere dati. Ogni oggetto è identificato da un numero di oggetto e un numero di generazione, come nell'esempio è che segue:
```
5 0 obj
<< /Length 72 >>
stream
BT
/F1 12 Tf
100 700 Td
(Hello, World!) Tj
ET
endstream
endobj
```
Utilizza **pdfid** per identificare gli oggetti e gli oggetti di tipo stream presenti nel PDF. Questo strumento aiuta a rilevare elementi sospetti come JavaScript, oggetti embed, e altro.
```
pdfid.py suspicious.pdf
```

In particolare, analizza l'output per elementi sospetti come /JavaScript, /OpenAction, /AA, /EmbededFile, /Launch, /Name, /URI ecc.

## Parsing e Analisi degli Oggetti PDF

Utilizza pdf-parser per esaminare più in dettaglio i contenuti del PDF, specialmente gli oggetti sospetti identificati con pdfid.

pdf-parser.py suspicious.pdf

Esamina gli oggetti uno per uno, prestando particolare attenzione agli oggetti che contengono JavaScript, collegamenti a URL esterni, o stream binari.

## Decodifica e Analisi dei Flussi

Utilizza **pdf-parser** per estrarre e decodificare i flussi di dati che possono contenere codice obfuscato o shellcode.

pdf-parser.py -o <object_number> -d suspicious.pdf

Se un flusso è compresso, decodificalo utilizzando gli strumenti integrati di pdf-parser.

## Analisi dei JavaScript Incorporati

Se il PDF contiene JavaScript, estrailo e analizzalo separatamente. Usa pdf-parser per identificare e estrarre gli oggetti JavaScript.
bash
Copy code
pdf-parser.py -o <object_number> -f suspicious.pdf

Analizza il JavaScript per identificare comportamenti dannosi, come il download di payload aggiuntivi o l'esecuzione di codice arbitrario.

## Ispezione dei Collegamenti e degli URL

Cerca collegamenti URL all'interno del PDF che potrebbero reindirizzare l'utente a siti web malevoli.

Usa pdf-parser o strumenti simili per estrarre e analizzare gli URL incorporati.

Strumenti come peepdf offrono un'interfaccia più avanzata per l'analisi dei PDF malevoli, permettendo di esplorare il documento in modo interattivo.
bash
Copy code
peepdf.py suspicious.pdf

## Documentazione e Report

Documenta tutti i passaggi eseguiti e i risultati ottenuti durante l'analisi. Include informazioni dettagliate sugli oggetti sospetti, il codice trovato e il comportamento previsto.

# Analisi statica di documenti Office malevoli

# Analisi statica di malware per Windows

# Creazione di un malware per Windows
